<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="http://unpkg.com/tone"></script>
    <!-- Collega il file CSS esterno -->
    <link rel="stylesheet" href="style.css">
</head>


<body>
    <div class="container">
        <!-- Titolo della pagina -->
        <div class="title">Sei pronto per Jammare con JamMate? Carica o registra la melodia che ti passa per la testa.</div>
        <!-- Bottone per iniziare -->
        <button class="start-button" id="startBtn">Iniziamo</button>
        <!-- Sezione nascosta con bottoni per caricare o registrare un file -->
        <div class="upload-record-buttons" id="actionButtons">
            <button id="uploadBtn">Carica un file audio</button>
            <div>
                <button id="recordBtn">Registra la tua traccia dal microfono</button>
                <input type="checkbox" id="toggle-bpm" name="toggle-bpm">
                <label for="bpm">usa BPM per registrare:</label>
                <input type="number" id="select-bpm" name="bpm" min="70" max="180" value="120">
            </div>
        </div>
        <!-- Timer per la registrazione -->
        
    </div>

    <div class="container2" style="display: none;">
        <button id="backBtn" class="styled-button">Torna indietro</button>
        
    <div class="selection-row">
        <div class="selection-container">
            <h1>Con che generi vorresti sperimentare oggi?</h1>
            <div class="genres">
            <button class="btn genre-btn">Rap</button>
            <button class="btn genre-btn">Latin</button>
            <button class="btn genre-btn">Jazz</button>
            <button class="btn genre-btn">Pop</button>
            <button class="btn genre-btn">Funk</button>
            </div>
        </div>
        <div class="selection-container">
            <h1>Quanto lungo vuoi che sia il tuo loop?</h1>
            <div class="loop-length">
            <button class="btn loop-btn">4 Bars</button>
            <button class="btn loop-btn">8 Bars</button>
            <button class="btn loop-btn">16 Bars</button>
            </div>
        </div>
    </div>
    <div class="selection-row">
        <div class="selection-container">
            <h1>Quale chiave detectata si addice alla tua faccia di cazzo?</h1>
            <div class="keys">
                <button class="btn key-btn"></button>
                <button class="btn key-btn"></button>
            </div>
        </div>
        <div class="selection-container">
            <h1>Scegli l'algoritmo per individuare il battere</h1>
            <div class="onset-algorythm">
                <button class="btn algorithm-btn">Algoritmo A</button>
                <button class="btn algorithm-btn">Algoritmo B</button>
                <input id="threshold" type="number" min="0" max="1" step="0.01" value="0.5">
                <button class="btn algorithm-btn">Algoritmo C</button>
                <button id="info-algorithm" class="info-btn">i</button>
                <button id="change-onset" class="styled-button">change onset</button>
            </div>
        </div>
    </div>
        <!-- Pulsante JAM -->
        <button id= "jam-button" class="styled-button">JAM!</button>
        <div class="controls" style="display: none;">
            <button id="start_Btn" class="styled-button">Start</button>
            <button id="stop_Btn" class="styled-button">Stop</button>
        </div>
        <div id="try"></div>

        <div class="container3">
            <div class="wavecontainer">
                <div id="melodyWaveform" class="waveform"></div>
                <div class="slidercontainer">
                    <div class="number">50</div>
                    <input type="range" min="0" max="100" value="50" class="slider" data-type="melody" data-param="volume">
                    <div class="label">Volume</div>
                </div>
                <div class="slidercontainer">
                    <div class="number">0</div>
                    <input type="range" min="0" max="100" value="0" class="slider" data-type="melody" data-param="reverb">
                    <div class="label">Reverb</div>
                </div>
                <div class="slidercontainer">
                    <div class="number">0</div>
                    <input type="range" min="0" max="100" value="0" class="slider" data-type="melody" data-param="delay">
                    <div class="label">Delay</div>
                </div>
            </div>
            <div class="wavecontainer">
                <div id="drumWaveform" class="waveform"></div>
                <div class="slidercontainer">
                    <div class="number">50</div>
                    <input type="range" min="0" max="100" value="50" class="slider" data-type="drum" data-param="volume">
                    <div class="label">Volume</div>
                </div>
                <div class="slidercontainer">
                    <div class="number">0</div>
                    <input type="range" min="0" max="100" value="0" class="slider" data-type="drum" data-param="reverb">
                    <div class="label">Reverb</div>
                </div>
                <div class="slidercontainer">
                    <div class="number">0</div>
                    <input type="range" min="0" max="100" value="0" class="slider" data-type="drum" data-param="delay">
                    <div class="label">Delay</div>
                </div>
            </div>
            <div class="wavecontainer">
                <div id="bassWaveform" class="waveform"></div>
                <div class="slidercontainer">
                    <div class="number">50</div>
                    <input type="range" min="0" max="100" value="50" class="slider" data-type="bass" data-param="volume">
                    <div class="label">Volume</div>
                </div>
                <div class="slidercontainer">
                    <div class="number">0</div>
                    <input type="range" min="0" max="100" value="0" class="slider" data-type="bass" data-param="reverb">
                    <div class="label">Reverb</div>
                </div>
                <div class="slidercontainer">
                    <div class="number">0</div>
                    <input type="range" min="0" max="100" value="0" class="slider" data-type="bass" data-param="delay">
                    <div class="label">Delay</div>
                </div>
            </div>
    </div>
</div>


<div id="bpmInfoContainer" class= "infoContainer">
    <button id="backToMainBpm" class="styled-button">Torna Indietro</button>
    <div id="infoContent">
        <div class="section">
            <h2>BPM Detection</h2>
            <ul>
                <li>1. The algorithm receives an audio buffer containing the sound data.</li>
                <li>2. It finds the peaks: The algorithm divides the audio into small "parts" and identifies volume peaks for each part.</li>
                <li>3. For each peak, the algorithm calculates the interval between that peak and the nearest peaks.</li>
            </ul>
            <img src="images/bpm1.png" alt="Image for steps 1-3">
        </div>

        <div class="section">
            <img src="images/bpm2.png" alt="Image for steps 4-5">
            <ul>
                <li>4. Each interval represents a potential beat of the song and is stored in a "group" object.</li>
                <li>5. The final BPM is determined by selecting the group with the most frequent BPM value.</li>
            </ul>
        </div>
    </div>
</div>
    
    

    <!-- Collega il file JavaScript esterno -->
    <script src="https://unpkg.com/wavesurfer.js"></script>
    <script src="https://unpkg.com/tone"></script>
    <script src="libs/dsp.js"></script>
    <script type="module" src="script.js"></script>
</body>
</html>
